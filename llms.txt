BJJ Vienna (Desktop + API) - Current Snapshot

Purpose
- Desktop app for BJJ academy operations (students, teachers, locations, sessions, attendance, reports).
- Optional API layer with JWT auth and role-based access for safer deployments.
- Main runtime stack: Python + Tkinter + PostgreSQL + FastAPI.

Canonical Architecture
- API implementation is centralized in `backend/main.py`.
- Root `main.py` is a compatibility wrapper that forwards to `backend.run`.
- Desktop remains modular under `ui/*.py`.

Tech Stack
- Python 3.x (release pipeline pinned to 3.11)
- Tkinter UI
- PostgreSQL via `psycopg2`
- FastAPI + Uvicorn
- PyJWT
- i18n JSON files in `i18n/`

Security/Runtime Highlights
- Login rate limiting is enabled in API (`/auth/login` can return 429 on repeated failures).
- Production/cloud startup validates secrets (`API_JWT_SECRET`, `API_ADMIN_PASSWORD`) and fails fast if weak/default.
- Backend env source of truth is `backend/.env*` (not root `.env*`).

Important Files
- `gui.py`: desktop entrypoint.
- `backend/main.py`: canonical FastAPI app.
- `backend/run.py`: API runner (`python -m backend.run`).
- `backend/config.py`: env/config loading and security validation.
- `main.py`: compatibility wrapper for API startup.
- `db.py`: desktop DB helper.
- `api_client.py`: desktop -> API client and token handling.
- `scripts/bootstrap_instance.py`: bootstrap backend env + client settings.
- `scripts/check_instance_config.py`: strict config validation.
- `installer/bjjvienna.iss`: installer definition.
- `.github/workflows/ci.yml`: CI (3.11 stable + 3.14 experimental).
- `.github/workflows/release.yml`: release workflow with lint/test quality gate.
- `docs/PROD_SECURITY_CHECKLIST.md`: production checklist.

Run / Test
- Desktop: `python gui.py`
- API (recommended): `python -m backend.run`
- API (compat): `python main.py`
- Tests: `pytest -q`

Conventions
- Keep changes small and behavior-compatible unless explicitly requested.
- Keep UI text changes synced in both `i18n/en.json` and `i18n/de-AT.json`.
- Do not commit secrets.
- If touching reports/export, validate CSV/PDF/Excel flows.
